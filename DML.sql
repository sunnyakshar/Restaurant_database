-----------------DATA MANUPULATION------------
Select * from Restaurant

INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden California','1350 North First Street,San Jose', 'Italian','11:00 AM to 2:00 AM'); 
INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden Texas','12870 Gulf Freeway,Houston','Mexican','11:00 AM to 2:00 AM'); 
INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden Florida','1555 Sand Lake Road,Orlando','Thai','11:00 AM to 2:00 AM'); 
INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden New york','2001 South Road,Poughkeepsie', 'Italian','11:00 AM to 2:00 AM');  
INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden Illinois','30 East Anthony Drive,Champaign','Mexican','11:00 AM to 2:00 AM'); 
INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden Georgia','905 Holcomb Bridge Road,Roswell','Thai','11:00 AM to 2:00 AM'); 
INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden Virginia','7505 Broken Branch Ln,Manassas', 'Italian','11:00 AM to 2:00 AM'); 
INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden Washington','11325 NE 124th Street,Kirkland','Mexican','11:00 AM to 2:00 AM'); 
INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden Arizona','1261 West Irvington Road,Tucson','Thai','11:00 AM to 2:00 AM'); 
INSERT INTO Restaurant (name, location, cuisine, Hours) VALUES ('Olive Garden Colorado','3255 Cinema Point,Colorado Springs', 'Italian','11:00 AM to 2:00 AM');

Select * from Employee

INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('John Doe', 'Manager', 50000.00, 1);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Jane Smith', 'Chef', 40000.00, 1);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Alice Johnson', 'Waitress', 30000.00, 1);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Mark John', 'Waiter', 30000.00, 1);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Bob Brown', 'Cleaner', 25000.00, 1);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('John Neol', 'Chef', 40000.00, 1);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Mary Deb', 'Waitress', 30000.00, 1);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Nik Johnson', 'Waiter', 30000.00, 1);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Maria Hussen', 'Cleaner', 25000.00, 1);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Maria Hussen', 'Cleaner', 25000.00, 1);
 
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Dana White', 'Manager', 55000.00, 2);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Charlie Davis', 'Chef', 40000.00, 2);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Fiona Green', 'Waitress', 28000.00, 2);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Edward King', 'Waiter', 30000.00, 2);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Hannah Scott', 'Cleaner', 25000.00, 2);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('George Long', 'Chef', 45000.00, 2);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Mia Wong', 'Waitress', 30000.00, 2);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Eli Nash', 'Waiter', 30000.00, 2);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Zeo Ford', 'Cleaner', 25000.00, 2);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Eva Roy', 'Cleaner', 25000.00, 2);
 
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Leo Yan', 'Manager', 55000.00, 3);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ian Kay', 'Chef', 40000.00, 3);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Lia Cox', 'Waitress', 28000.00, 3);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Noah Lee', 'Waiter', 30000.00, 3);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Hamy Tao', 'Cleaner', 25000.00, 3);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Max Joy', 'Chef', 45000.00, 3);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Tara Reid', 'Waitress', 30000.00, 3);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Sam Fox', 'Waiter', 30000.00, 3);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ian Lowe', 'Cleaner', 25000.00, 3);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Mia Hill', 'Cleaner', 25000.00, 3);
 
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Leo Hunt', 'Manager', 55000.00, 4);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Zoe Bird', 'Chef', 40000.00, 4);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Max Cook', 'Waitress', 28000.00, 4);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Lily Shaw', 'Waiter', 30000.00, 4);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Jake Pool', 'Cleaner', 25000.00, 4);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Tia Lee', 'Chef', 45000.00, 4);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Jay Kim', 'Waitress', 30000.00, 4);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Zoe Cox', 'Waiter', 30000.00, 4);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Kai Tao', 'Cleaner', 25000.00, 4);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Eva Ray', 'Cleaner', 25000.00, 4);
 
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ian Joy', 'Manager', 55000.00, 5);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ada Fox', 'Chef', 40000.00, 5);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Leo Wu', 'Waitress', 28000.00, 5);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Lia Zhu', 'Waiter', 30000.00, 5);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ben Roy', 'Cleaner', 25000.00, 5);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ava Lee', 'Chef', 45000.00, 5);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Tom Day', 'Waitress', 30000.00, 5);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Zoe May', 'Waiter', 30000.00, 5);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Eva Joy', 'Cleaner', 25000.00, 5);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Kai Low', 'Cleaner', 25000.00, 5);
 
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ava Lee', 'Manager', 55000.00, 6);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Tom Day', 'Chef', 40000.00, 6);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Zoe May', 'Waitress', 28000.00, 6);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ian Poe', 'Waiter', 30000.00, 6);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Eva Joy', 'Cleaner', 25000.00, 6);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Max Roe', 'Chef', 45000.00, 6);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Nia Fox', 'Waitress', 30000.00, 6);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Leo Bay', 'Waiter', 30000.00, 6);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Lia Fay', 'Cleaner', 25000.00, 6);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Kai High', 'Cleaner', 25000.00, 6);
 
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Shwe Krish', 'Manager', 55000.00, 7);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Sue Kim', 'Chef', 40000.00, 7);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ben Zhu', 'Waitress', 28000.00, 7);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Mia Tao', 'Waiter', 30000.00, 7);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ray Cox', 'Cleaner', 25000.00, 7);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Eli Dee', 'Chef', 45000.00, 7);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Amy Ray', 'Waitress', 30000.00, 7);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Tim Kay', 'Waiter', 30000.00, 7);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ned Joy', 'Cleaner', 25000.00, 7);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Liz Rue', 'Cleaner', 25000.00, 7);
 
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Nia Moss', 'Manager', 55000.00, 8);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Rob Finn', 'Chef', 40000.00, 8);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Zoe Hart', 'Waitress', 28000.00, 8);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Leo Gage', 'Waiter', 30000.00, 8);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Eva Wood', 'Cleaner', 25000.00, 8);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Sam Cook', 'Chef', 45000.00, 8);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Lia West', 'Waitress', 30000.00, 8);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Jay Wolf', 'Waiter', 30000.00, 8);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Mia Shaw', 'Cleaner', 25000.00, 8);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Jon Snow', 'Cleaner', 25000.00, 8);
 
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Eve Park', 'Manager', 55000.00, 9);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Tim Reed', 'Chef', 40000.00, 9);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ana Hill', 'Waitress', 28000.00, 9);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Max Lake', 'Waiter', 30000.00, 9);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Kim Dale', 'Cleaner', 25000.00, 9);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Pat Dean', 'Chef', 45000.00, 9);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Rex Tate', 'Waitress', 30000.00, 9);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Zac Best', 'Waiter', 30000.00, 9);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Dot King', 'Cleaner', 25000.00, 9);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Lou Bird', 'Cleaner', 25000.00, 9);
 
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Kai Cole', 'Manager', 55000.00, 10);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ned Bell', 'Chef', 40000.00, 10);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Tia Rose', 'Waitress', 28000.00, 10);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Ian Dunn', 'Waiter', 30000.00, 10);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Fay Hope', 'Cleaner', 25000.00, 10);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Sid Wade', 'Chef', 45000.00, 10);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Meg Lane', 'Waitress', 30000.00, 10);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Roy Earl', 'Waiter', 30000.00, 10);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Gus Ford', 'Cleaner', 25000.00, 10);
INSERT INTO Employee (Name, Role, Salary, restaurant_id) VALUES ('Amy Peak', 'Cleaner', 25000.00, 10);

Select * from Employee


SELECT * from Orders
-- DML for Orders table

DO $$
DECLARE
    emp_id INTEGER;
	restaurant_id INTEGER;
BEGIN
    FOR emp_id IN 101..200 LOOP
	-- Select a random restaurant_id between 1 and 10
        restaurant_id := (RANDOM() * 9 + 1)::INTEGER;
        -- Insert 10 orders for each employee
        FOR i IN 1..10 LOOP
            INSERT INTO Orders (Employee_ID, Order_Total, Order_Table_Number, Order_Payment_Method, Order_Status, restaurant_id)
            VALUES (
                emp_id,
                ROUND((RANDOM() * 275 + 25)::numeric, 2),  -- Random order total between 25 and 300
                CAST((RANDOM() * 20 + 1) AS INTEGER),             -- Random table number between 1 and 20
                CASE CAST((RANDOM() * 1) AS INTEGER)             -- Random payment method
                    WHEN 0 THEN 'Cash'
                    ELSE 'Credit Card'
                END,
                CASE CAST((RANDOM() * 1) AS INTEGER)             -- Random order status
                    WHEN 0 THEN 'Completed'
                    ELSE 'In Progress'
                END,
				restaurant_id
            );
        END LOOP;
    END LOOP;
END $$;


CREATE EXTENSION IF NOT EXISTS pgcrypto;

INSERT INTO Customer (Order_ID, Customer_Contact, Customer_email, Customer_name)
SELECT 
    (1000 + random() * 1000)::BIGINT, -- Random Order_ID between 1001 and 2000
    floor(random() * 10000000000)::BIGINT, -- Random Customer_Contact (10 digits)
    substr(md5(random()::text), 0, 20) || '@example.com', -- Random Customer_email
    substr(md5(random()::text), 0, 10) -- Random Customer_name
FROM generate_series(1, 1000); -- Insert 1000 random customer entries

SELECT * FROM Customer
	------DROP Table customer---

---Query----

-- Select all columns and all rows from one table
SELECT * FROM Restaurant;
 
-- Select five columns and all rows from one table
SELECT Employee_ID, Name, Role, Salary, Restaurant_ID FROM Employee;
 
-- Select all columns from all rows from one view
CREATE VIEW Review AS
SELECT Employee.Name, Employee.Role, Restaurant.Name AS Restaurant_Name, Orders.Order_ID, Orders.Order_Total
FROM Employee
JOIN Restaurant ON Employee.Restaurant_ID = Restaurant.Restaurant_ID
JOIN Orders ON Employee.Employee_ID = Orders.Employee_ID
-- Query from the view
SELECT * FROM Review;

SELECT Employee.Name, Employee.Role, Restaurant.Name AS Restaurant_Name, Orders.Order_ID, Orders.Order_Total
FROM Employee
JOIN Restaurant ON Employee.Restaurant_ID = Restaurant.Restaurant_ID
JOIN Orders ON Employee.Employee_ID = Orders.Employee_ID
 
-- Using a join on 2 tables, select all columns and all rows from the tables without the use of a Cartesian product
SELECT * FROM Employee
JOIN Restaurant ON Employee.Restaurant_ID = Restaurant.Restaurant_ID;
 
-- Select and order data retrieved from one table
SELECT * FROM Employee
ORDER BY Salary DESC;
 
-- Using a join on 3 tables, select 5 columns from the 3 tables. Use syntax that would limit the output to 3 rows
SELECT Employee.Name, Employee.Role, Restaurant.Name AS Restaurant_Name, Orders.Order_ID, Orders.order_Total
FROM Employee
JOIN Restaurant ON Employee.Restaurant_ID = Restaurant.Restaurant_ID
JOIN Orders ON Employee.Employee_ID = Orders.Employee_ID
LIMIT 3;
 
-- Select distinct rows using joins on 3 tables
SELECT DISTINCT Employee.Name, Restaurant.Name AS Restaurant_Name, Orders.Order_ID
FROM Employee
JOIN Restaurant ON Employee.Restaurant_ID = Restaurant.Restaurant_ID
JOIN Orders ON Employee.Employee_ID = Orders.Employee_ID;
 
-- Use GROUP BY and HAVING in a select statement using one or more tables
SELECT Employee_ID, COUNT(*) AS Num_Orders, SUM(Order_total) AS Total_Sales
FROM Orders
GROUP BY Employee_ID
HAVING COUNT(*) > 5;
 
-- Use IN clause to select data from one or more tables
SELECT * FROM Employee
WHERE salary IN (28069.85);
 
--  Select length of one column from one table (use LENGTH function)
SELECT Name, LENGTH(Name) AS Name_Length FROM Employee;
 
-- Delete one record from one table. Use select statements to demonstrate the table contents before and after the DELETE statement. Make sure you use ROLLBACK afterwards so that the data will not be physically removed
-- Display before deletion
SELECT * FROM Customer;
-- Deleting an employee record
DELETE FROM Customer WHERE Customer_ID = 7001;
-- Display after deletion
SELECT * FROM Customer;
-- Rollback the deletion to preserve data
ROLLBACK;
 
-- Update One Record from One Table
-- Display before update
SELECT * FROM Employee WHERE Employee_ID = 122;
-- Update the record
UPDATE Employee SET Salary = 55000.00 WHERE Employee_ID = 122;
-- Display after update
SELECT * FROM Employee WHERE Employee_ID = 122;
-- Rollback the update to preserve original data
ROLLBACK;
 
-- Advanced Query 1: Aggregated Sales by Restaurant

SELECT Restaurant.Name, COUNT(Orders.Order_ID) AS Total_Orders, SUM(Order_total) AS Total_Sales
FROM Orders
JOIN Employee ON Orders.Employee_ID = Employee.Employee_ID
JOIN Restaurant ON Employee.Restaurant_ID = Restaurant.Restaurant_ID
GROUP BY Restaurant.Name
ORDER BY Total_Sales DESC;

 
--Advanced Query 2: Employees with Most Sales in Top Selling Restaurants--
WITH Restaurant_Sales AS (
SELECT restaurant_id, SUM(Order_Total) AS Total_Sales
FROM Orders
GROUP BY restaurant_id
ORDER BY Total_Sales DESC
LIMIT 3
)
SELECT Employee.Name, Employee.Role, R.Name AS restaurant_Name, SUM(Orders.Order_total) AS Employee_Sales
FROM Orders
JOIN Employee ON Orders.Employee_ID = Employee.Employee_ID
JOIN Restaurant R ON Employee.Restaurant_ID = R.Restaurant_ID
JOIN Restaurant_Sales RS ON R.Restaurant_ID = RS.Restaurant_ID
GROUP BY Employee.Employee_ID, R.Name
ORDER BY Employee_Sales DESC;


SELECT * from restaurant;

